# 🚀 WindowsCleaner - Windows 系统清理工具

---

![CMD图标](https://img.icons8.com/fluency/48/console.png)

一个基于批处理的 Windows 系统垃圾清理工具，清理系统日常垃圾。帮助快速清理临时文件、回收站及系统缓存。

## 📂 功能特性

- **多维度清理**  
  ✔️ 用户临时文件夹  
  ✔️ 系统临时目录  
  ✔️ 回收站全清空  
  ✔️ 预读取缓存文件  
  ✔️ 系统错误报告  
  ✔️ Windows 更新缓存

- **智能处理**  
  🔐 自动请求管理员权限  
  ⚠️ 交互式确认机制  
  📝 实时清理进度反馈  
  ❌ 标注无法删除的占用文件

- **安全机制**  
  🛡️ 绕过 PowerShell 执行策略  
  📍 限定清理系统指定目录  
  ⚠️ 关键操作前二次确认

## 🚀 使用方法

1. **下载脚本**  
   将本项目 clone 保存至任意目录（建议放在桌面或不被清理的目录），或者复制粘贴里面的内容到一个文本文件中，并另存为 WindowsCleanMaster.bat，编码格式选择 ANSI。

2. **运行要求**  
   ▶️ 右键点击 WindowsCleanMaster.bat 选择"以管理员身份运行"  
   ▶️ 或普通账户运行时自动提权

3. **执行清理**

- **脚本运行后，自动进入交互模式。**

- **确认开始清理 (Y/N)**：输入 `Y` 或回车继续，输入 `N` 取消。
- **选择是否清空回收站 (Y/N)**：输入 `Y` 或回车清空，输入 `N` 跳过。
- **分阶段显示清理进度**：脚本会显示当前正在清理的区域和文件。
- **最终完成统计报告**：所有清理完成后，会显示“系统垃圾清理完成！”的提示。

---

## ⚠️ 注意事项

### **系统影响**

- 🚫 **清理 Windows 更新缓存需重启服务**：在清理 Windows 更新临时文件时，脚本会临时停止 BITS 和 Windows Update 服务以解除文件占用，清理完成后会自动重启服务。这通常不会对系统造成负面影响。
- 📁 **缩略图缓存将完全重建**：清理缩略图缓存后，下次访问图片或视频文件夹时，系统会重新生成缩略图，这可能需要一些时间。
- 🔍 **预读取文件清理可能影响启动速度**：预读取文件用于加速应用程序启动。清理后，首次启动某些程序可能会稍慢，但随着使用会重新建立缓存。

### **兼容性**

- ✔️ 支持 Windows 7/10/11 操作系统。
- ✔️ 适配 32 位和 64 位系统。

### **风险提示**

- ⚠️ **可能会误删重要文件**：脚本会尝试自动跳过某些系统目录，但仍然可能误删重要文件。建议在运行脚本前，先手动备份重要文件。

- ⚠️ **可能影响某些软件的临时数据**：某些正在运行的应用程序的临时文件可能无法被清理，或者如果清理了正在使用的临时文件（虽然脚本会尽量避免），可能会导致程序异常。建议在运行清理工具前关闭不必要的应用程序。
- ⚠️ **长期未清理的系统首次执行耗时较长**：如果您的系统长时间未清理，临时文件累积较多，首次执行清理可能需要较长时间。

---

## 📜 免责声明

本工具按"原样"提供，开发者不对以下情况负责：

- 系统配置变更导致的异常
- 重要数据意外丢失
- 企业环境中的策略冲突
- 杀毒软件误报问题

**建议首次使用前：**

- **创建系统还原点**：以防万一，可以在系统出现问题时恢复到之前的状态。
- **备份个人数据**：重要文件请务必备份。
- **关闭防病毒软件**：某些安全软件可能会阻止脚本的某些操作，导致清理不彻底。
